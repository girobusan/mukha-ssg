---
title: Обработка данных

doc: data_config_ru

---

В редких случаях вам может понадобится (или захотеться) не просто подключить данные к сайту, но и обработать их, и/или сгенерировать из них страницы для сайта. **Делать это совершенно необязательно**, но возможно. 

----

Конфигурационный файл `data.config.yaml` (или `data.config.json`) определяет, каким образом будут обработаны данные перед их подключением к сайту. В нем же настраивается генерация страниц из данных. 

Файл пишется в формате `yaml` или `json`.  Состоит из списка действий над данными (массив объектов). Все действия, описанные в файле производятся последовательно, кроме генерации страниц — страницы генерируются строго после того, как будут произведены все остальные действия.

 Кажое действие описывается по одной схеме, пример в `yaml`:

У каждого действия есть обязательные параметры `dataset` и `task`.

```yaml
- task: <название действия>
  dataset: <имя датасета>
  ... остальные параметры могут меняться в зависимости от действия
```

Действия можно производить только над табличными данными, т. е. такими, которые можно представить в виде таблице. Количество действий не ограничено ничем, кроме здравого смысла.

Данные, которые не являются таблицей, можно использовать на страницах, вставлять в шаблоны, но обрабатывать их не получится. 

## Действия с данными

### slugify

Создает новую колонку на основе выбранной, в которой каждому значению из выбранной колонки соотвествует уникальная строка, состоящая из букв латинского алфавита, цифр и знаков подчеркивания. Эта функция нужна для создания страниц — результат ее выполнения всегда можно использовать как часть URL. 

Например, если у вас есть табличка с именами актеров, а вам нужно создать по странице для каждого из них, можно с помощью `slugify` добавить столбец, который потом использовать при генерации страниц как имя файла.  Например:

```yaml
- task: slugify
  dataset: tables.movies
  input_col: actor_name
  output_col: actor_page_name
```

#### Параметры:

- `input_col` — колонка, на основе которой будет создана новая колонка

- `output_col` — имя новой колонки

### sort

Сортирует датасет по заданной колонке.

#### Параметры:

- `col`—  по какой колонке сортировать

- `as_number` —  логическое значение — интерпретировать ли содержимое колонки как число. Результат может быть неожиданным, так как локаль не учитывается.

- `desc`— логическое значение, сортировка в нисходящем порядке.

### aggregate

Конечно, данные лучше подготавливать заранее, но все мы люди. Действие `aggregate` позволяет делать простые агрегации — сумма, число, медиана. Например, так можно добавить в табличку, в которой перечислены актеры и фильмы, в которых они снимались, количество фильмов с участием каждого актера:

```yaml
- task: aggregate
  dataset: table.actors
  type: count_u
  col: movie_name
  group_by: actor_name # Необязательный параметр.
  output_col: filmed_in
```

#### Параметры:

- `type` — тип аггрегации,   `count`, `count_u`, `sum`, `average`, `median`

- `col` —  колонка, в которой будет производится агрегация

- `group_by` — необязательно, колонка, по которой будут сгруппированы значения

- `output_col` — название новой колонки, в которую будут записаны результаты

### render

Это действие опеределяет, как и какие страницы будут созданы из данных. Муха поддерживает два способа создания страниц: по строкам и по колонкам. 
